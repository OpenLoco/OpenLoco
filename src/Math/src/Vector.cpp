#include "Vector.hpp"
#include <array>

namespace OpenLoco::Math::Vector
{
    namespace Data
    {
        // clang-format off
        // 0x00500B50
        constexpr std::array<uint16_t, 2048> kFastSquareRootTable = {
                0,  1448,  2048,  2508,  2896,  3238,  3547,  3831,  4096,  4344,  4579,  4802,  5016,  5221,  5418,  5608,  5792,  5970,  6144,  6312,
             6476,  6636,  6792,  6945,  7094,  7240,  7384,  7524,  7662,  7798,  7931,  8062,  8192,  8319,  8444,  8567,  8688,  8808,  8927,  9043,
             9158,  9272,  9385,  9496,  9605,  9714,  9821,  9928, 10033, 10137, 10240, 10341, 10442, 10542, 10641, 10739, 10836, 10933, 11028, 11123,
            11217, 11310, 11402, 11494, 11585, 11675, 11764, 11853, 11941, 12029, 12116, 12202, 12288, 12373, 12457, 12541, 12624, 12707, 12789, 12871,
            12952, 13033, 13113, 13193, 13272, 13351, 13429, 13507, 13584, 13661, 13738, 13814, 13890, 13965, 14040, 14114, 14188, 14262, 14336, 14408,
            14481, 14553, 14625, 14697, 14768, 14839, 14909, 14979, 15049, 15119, 15188, 15257, 15325, 15394, 15462, 15529, 15597, 15664, 15730, 15797,
            15863, 15929, 15995, 16060, 16125, 16190, 16255, 16319, 16384, 16447, 16511, 16574, 16638, 16700, 16763, 16826, 16888, 16950, 17011, 17073,
            17134, 17195, 17256, 17317, 17377, 17438, 17498, 17557, 17617, 17676, 17736, 17795, 17854, 17912, 17971, 18029, 18087, 18145, 18203, 18260,
            18317, 18375, 18432, 18488, 18545, 18601, 18658, 18714, 18770, 18826, 18881, 18937, 18992, 19047, 19102, 19157, 19211, 19266, 19320, 19374,
            19429, 19482, 19536, 19590, 19643, 19697, 19750, 19803, 19856, 19908, 19961, 20013, 20066, 20118, 20170, 20222, 20274, 20325, 20377, 20428,
            20480, 20531, 20582, 20633, 20683, 20734, 20784, 20835, 20885, 20935, 20985, 21035, 21085, 21135, 21184, 21234, 21283, 21332, 21381, 21430,
            21479, 21528, 21577, 21625, 21673, 21722, 21770, 21818, 21866, 21914, 21962, 22010, 22057, 22105, 22152, 22199, 22246, 22294, 22341, 22387,
            22434, 22481, 22528, 22574, 22620, 22667, 22713, 22759, 22805, 22851, 22897, 22943, 22988, 23034, 23079, 23125, 23170, 23215, 23260, 23305,
            23350, 23395, 23440, 23485, 23529, 23574, 23618, 23663, 23707, 23751, 23795, 23839, 23883, 23927, 23971, 24014, 24058, 24102, 24145, 24188,
            24232, 24275, 24318, 24361, 24404, 24447, 24490, 24533, 24576, 24618, 24661, 24703, 24746, 24788, 24830, 24872, 24914, 24957, 24999, 25040,
            25082, 25124, 25166, 25207, 25249, 25290, 25332, 25373, 25415, 25456, 25497, 25538, 25579, 25620, 25661, 25702, 25742, 25783, 25824, 25864,
            25905, 25945, 25986, 26026, 26066, 26106, 26147, 26187, 26227, 26267, 26307, 26346, 26386, 26426, 26465, 26505, 26545, 26584, 26624, 26663,
            26702, 26741, 26781, 26820, 26859, 26898, 26937, 26976, 27014, 27053, 27092, 27131, 27169, 27208, 27246, 27285, 27323, 27362, 27400, 27438,
            27476, 27514, 27553, 27591, 27629, 27666, 27704, 27742, 27780, 27818, 27855, 27893, 27930, 27968, 28005, 28043, 28080, 28118, 28155, 28192,
            28229, 28266, 28303, 28340, 28377, 28414, 28451, 28488, 28525, 28562, 28598, 28635, 28672, 28708, 28745, 28781, 28817, 28854, 28890, 28926,
            28963, 28999, 29035, 29071, 29107, 29143, 29179, 29215, 29251, 29287, 29322, 29358, 29394, 29429, 29465, 29501, 29536, 29572, 29607, 29642,
            29678, 29713, 29748, 29784, 29819, 29854, 29889, 29924, 29959, 29994, 30029, 30064, 30099, 30134, 30168, 30203, 30238, 30273, 30307, 30342,
            30376, 30411, 30445, 30480, 30514, 30548, 30583, 30617, 30651, 30685, 30720, 30754, 30788, 30822, 30856, 30890, 30924, 30958, 30991, 31025,
            31059, 31093, 31126, 31160, 31194, 31227, 31261, 31294, 31328, 31361, 31395, 31428, 31461, 31495, 31528, 31561, 31595, 31628, 31661, 31694,
            31727, 31760, 31793, 31826, 31859, 31892, 31925, 31957, 31990, 32023, 32056, 32088, 32121, 32154, 32186, 32219, 32251, 32284, 32316, 32349,
            32381, 32414, 32446, 32478, 32510, 32543, 32575, 32607, 32639, 32671, 32703, 32735, 32768, 32799, 32831, 32863, 32895, 32927, 32959, 32991,
            33023, 33054, 33086, 33118, 33149, 33181, 33212, 33244, 33276, 33307, 33339, 33370, 33401, 33433, 33464, 33495, 33527, 33558, 33589, 33620,
            33652, 33683, 33714, 33745, 33776, 33807, 33838, 33869, 33900, 33931, 33962, 33993, 34023, 34054, 34085, 34116, 34146, 34177, 34208, 34238,
            34269, 34300, 34330, 34361, 34391, 34422, 34452, 34483, 34513, 34543, 34574, 34604, 34634, 34665, 34695, 34725, 34755, 34785, 34816, 34846,
            34876, 34906, 34936, 34966, 34996, 35026, 35056, 35086, 35115, 35145, 35175, 35205, 35235, 35264, 35294, 35324, 35353, 35383, 35413, 35442,
            35472, 35501, 35531, 35560, 35590, 35619, 35649, 35678, 35708, 35737, 35766, 35796, 35825, 35854, 35883, 35913, 35942, 35971, 36000, 36029,
            36058, 36087, 36116, 36145, 36174, 36203, 36232, 36261, 36290, 36319, 36348, 36377, 36406, 36434, 36463, 36492, 36521, 36549, 36578, 36607,
            36635, 36664, 36692, 36721, 36750, 36778, 36807, 36835, 36864, 36892, 36920, 36949, 36977, 37005, 37034, 37062, 37090, 37119, 37147, 37175,
            37203, 37231, 37260, 37288, 37316, 37344, 37372, 37400, 37428, 37456, 37484, 37512, 37540, 37568, 37596, 37624, 37652, 37679, 37707, 37735,
            37763, 37791, 37818, 37846, 37874, 37901, 37929, 37957, 37984, 38012, 38039, 38067, 38095, 38122, 38150, 38177, 38204, 38232, 38259, 38287,
            38314, 38341, 38369, 38396, 38423, 38451, 38478, 38505, 38532, 38560, 38587, 38614, 38641, 38668, 38695, 38722, 38749, 38777, 38804, 38831,
            38858, 38885, 38912, 38938, 38965, 38992, 39019, 39046, 39073, 39100, 39126, 39153, 39180, 39207, 39234, 39260, 39287, 39314, 39340, 39367,
            39394, 39420, 39447, 39473, 39500, 39526, 39553, 39579, 39606, 39632, 39659, 39685, 39712, 39738, 39764, 39791, 39817, 39843, 39870, 39896,
            39922, 39949, 39975, 40001, 40027, 40053, 40080, 40106, 40132, 40158, 40184, 40210, 40236, 40262, 40288, 40314, 40340, 40366, 40392, 40418,
            40444, 40470, 40496, 40522, 40548, 40574, 40600, 40625, 40651, 40677, 40703, 40728, 40754, 40780, 40806, 40831, 40857, 40883, 40908, 40934,
            40960, 40985, 41011, 41036, 41062, 41087, 41113, 41138, 41164, 41189, 41215, 41240, 41266, 41291, 41316, 41342, 41367, 41392, 41418, 41443,
            41468, 41494, 41519, 41544, 41569, 41595, 41620, 41645, 41670, 41695, 41720, 41746, 41771, 41796, 41821, 41846, 41871, 41896, 41921, 41946,
            41971, 41996, 42021, 42046, 42071, 42096, 42121, 42146, 42170, 42195, 42220, 42245, 42270, 42295, 42319, 42344, 42369, 42394, 42418, 42443,
            42468, 42492, 42517, 42542, 42566, 42591, 42616, 42640, 42665, 42689, 42714, 42738, 42763, 42788, 42812, 42836, 42861, 42885, 42910, 42934,
            42959, 42983, 43008, 43032, 43056, 43081, 43105, 43129, 43154, 43178, 43202, 43226, 43251, 43275, 43299, 43323, 43347, 43372, 43396, 43420,
            43444, 43468, 43492, 43516, 43541, 43565, 43589, 43613, 43637, 43661, 43685, 43709, 43733, 43757, 43781, 43805, 43829, 43853, 43876, 43900,
            43924, 43948, 43972, 43996, 44020, 44043, 44067, 44091, 44115, 44139, 44162, 44186, 44210, 44233, 44257, 44281, 44305, 44328, 44352, 44375,
            44399, 44423, 44446, 44470, 44493, 44517, 44541, 44564, 44588, 44611, 44635, 44658, 44682, 44705, 44728, 44752, 44775, 44799, 44822, 44846,
            44869, 44892, 44916, 44939, 44962, 44986, 45009, 45032, 45056, 45079, 45102, 45125, 45148, 45172, 45195, 45218, 45241, 45264, 45288, 45311,
            45334, 45357, 45380, 45403, 45426, 45449, 45472, 45496, 45519, 45542, 45565, 45588, 45611, 45634, 45657, 45680, 45702, 45725, 45748, 45771,
            45794, 45817, 45840, 45863, 45886, 45909, 45931, 45954, 45977, 46000, 46023, 46045, 46068, 46091, 46114, 46136, 46159, 46182, 46204, 46227,
            46250, 46273, 46295, 46318, 46340, 46363, 46386, 46408, 46431, 46453, 46476, 46499, 46521, 46544, 46566, 46589, 46611, 46634, 46656, 46679,
            46701, 46724, 46746, 46768, 46791, 46813, 46836, 46858, 46880, 46903, 46925, 46947, 46970, 46992, 47014, 47037, 47059, 47081, 47104, 47126,
            47148, 47170, 47192, 47215, 47237, 47259, 47281, 47303, 47326, 47348, 47370, 47392, 47414, 47436, 47458, 47480, 47503, 47525, 47547, 47569,
            47591, 47613, 47635, 47657, 47679, 47701, 47723, 47745, 47767, 47789, 47811, 47832, 47854, 47876, 47898, 47920, 47942, 47964, 47986, 48008,
            48029, 48051, 48073, 48095, 48117, 48138, 48160, 48182, 48204, 48225, 48247, 48269, 48291, 48312, 48334, 48356, 48377, 48399, 48421, 48442,
            48464, 48486, 48507, 48529, 48550, 48572, 48594, 48615, 48637, 48658, 48680, 48701, 48723, 48744, 48766, 48787, 48809, 48830, 48852, 48873,
            48895, 48916, 48938, 48959, 48981, 49002, 49023, 49045, 49066, 49087, 49109, 49130, 49152, 49173, 49194, 49215, 49237, 49258, 49279, 49301,
            49322, 49343, 49364, 49386, 49407, 49428, 49449, 49470, 49492, 49513, 49534, 49555, 49576, 49597, 49619, 49640, 49661, 49682, 49703, 49724,
            49745, 49766, 49787, 49808, 49829, 49851, 49872, 49893, 49914, 49935, 49956, 49977, 49998, 50019, 50039, 50060, 50081, 50102, 50123, 50144,
            50165, 50186, 50207, 50228, 50249, 50269, 50290, 50311, 50332, 50353, 50374, 50394, 50415, 50436, 50457, 50478, 50498, 50519, 50540, 50561,
            50581, 50602, 50623, 50644, 50664, 50685, 50706, 50726, 50747, 50768, 50788, 50809, 50830, 50850, 50871, 50891, 50912, 50933, 50953, 50974,
            50994, 51015, 51035, 51056, 51076, 51097, 51118, 51138, 51159, 51179, 51200, 51220, 51240, 51261, 51281, 51302, 51322, 51343, 51363, 51383,
            51404, 51424, 51445, 51465, 51485, 51506, 51526, 51546, 51567, 51587, 51607, 51628, 51648, 51668, 51689, 51709, 51729, 51750, 51770, 51790,
            51810, 51830, 51851, 51871, 51891, 51911, 51932, 51952, 51972, 51992, 52012, 52032, 52053, 52073, 52093, 52113, 52133, 52153, 52173, 52193,
            52213, 52234, 52254, 52274, 52294, 52314, 52334, 52354, 52374, 52394, 52414, 52434, 52454, 52474, 52494, 52514, 52534, 52554, 52574, 52594,
            52614, 52633, 52653, 52673, 52693, 52713, 52733, 52753, 52773, 52793, 52812, 52832, 52852, 52872, 52892, 52912, 52931, 52951, 52971, 52991,
            53011, 53030, 53050, 53070, 53090, 53109, 53129, 53149, 53169, 53188, 53208, 53228, 53248, 53267, 53287, 53307, 53326, 53346, 53366, 53385,
            53405, 53424, 53444, 53464, 53483, 53503, 53522, 53542, 53562, 53581, 53601, 53620, 53640, 53659, 53679, 53699, 53718, 53738, 53757, 53777,
            53796, 53816, 53835, 53855, 53874, 53893, 53913, 53932, 53952, 53971, 53991, 54010, 54029, 54049, 54068, 54088, 54107, 54126, 54146, 54165,
            54184, 54204, 54223, 54243, 54262, 54281, 54300, 54320, 54339, 54358, 54378, 54397, 54416, 54435, 54455, 54474, 54493, 54512, 54532, 54551,
            54570, 54589, 54609, 54628, 54647, 54666, 54685, 54704, 54724, 54743, 54762, 54781, 54800, 54819, 54839, 54858, 54877, 54896, 54915, 54934,
            54953, 54972, 54991, 55010, 55029, 55048, 55067, 55087, 55106, 55125, 55144, 55163, 55182, 55201, 55220, 55239, 55258, 55277, 55296, 55314,
            55333, 55352, 55371, 55390, 55409, 55428, 55447, 55466, 55485, 55504, 55523, 55541, 55560, 55579, 55598, 55617, 55636, 55655, 55673, 55692,
            55711, 55730, 55749, 55768, 55786, 55805, 55824, 55843, 55861, 55880, 55899, 55918, 55937, 55955, 55974, 55993, 56011, 56030, 56049, 56068,
            56086, 56105, 56124, 56142, 56161, 56180, 56198, 56217, 56236, 56254, 56273, 56292, 56310, 56329, 56347, 56366, 56385, 56403, 56422, 56440,
            56459, 56478, 56496, 56515, 56533, 56552, 56570, 56589, 56607, 56626, 56644, 56663, 56681, 56700, 56718, 56737, 56755, 56774, 56792, 56811,
            56829, 56848, 56866, 56885, 56903, 56921, 56940, 56958, 56977, 56995, 57013, 57032, 57050, 57069, 57087, 57105, 57124, 57142, 57160, 57179,
            57197, 57215, 57234, 57252, 57270, 57289, 57307, 57325, 57344, 57362, 57380, 57398, 57417, 57435, 57453, 57471, 57490, 57508, 57526, 57544,
            57563, 57581, 57599, 57617, 57635, 57654, 57672, 57690, 57708, 57726, 57744, 57763, 57781, 57799, 57817, 57835, 57853, 57871, 57889, 57908,
            57926, 57944, 57962, 57980, 57998, 58016, 58034, 58052, 58070, 58088, 58106, 58124, 58143, 58161, 58179, 58197, 58215, 58233, 58251, 58269,
            58287, 58305, 58323, 58341, 58359, 58376, 58394, 58412, 58430, 58448, 58466, 58484, 58502, 58520, 58538, 58556, 58574, 58592, 58610, 58627,
            58645, 58663, 58681, 58699, 58717, 58735, 58752, 58770, 58788, 58806, 58824, 58842, 58859, 58877, 58895, 58913, 58931, 58948, 58966, 58984,
            59002, 59020, 59037, 59055, 59073, 59091, 59108, 59126, 59144, 59162, 59179, 59197, 59215, 59232, 59250, 59268, 59285, 59303, 59321, 59339,
            59356, 59374, 59392, 59409, 59427, 59444, 59462, 59480, 59497, 59515, 59533, 59550, 59568, 59585, 59603, 59621, 59638, 59656, 59673, 59691,
            59708, 59726, 59744, 59761, 59779, 59796, 59814, 59831, 59849, 59866, 59884, 59901, 59919, 59936, 59954, 59971, 59989, 60006, 60024, 60041,
            60059, 60076, 60094, 60111, 60128, 60146, 60163, 60181, 60198, 60216, 60233, 60250, 60268, 60285, 60303, 60320, 60337, 60355, 60372, 60389,
            60407, 60424, 60442, 60459, 60476, 60494, 60511, 60528, 60546, 60563, 60580, 60597, 60615, 60632, 60649, 60667, 60684, 60701, 60718, 60736,
            60753, 60770, 60788, 60805, 60822, 60839, 60856, 60874, 60891, 60908, 60925, 60943, 60960, 60977, 60994, 61011, 61029, 61046, 61063, 61080,
            61097, 61114, 61132, 61149, 61166, 61183, 61200, 61217, 61234, 61251, 61269, 61286, 61303, 61320, 61337, 61354, 61371, 61388, 61405, 61422,
            61440, 61457, 61474, 61491, 61508, 61525, 61542, 61559, 61576, 61593, 61610, 61627, 61644, 61661, 61678, 61695, 61712, 61729, 61746, 61763,
            61780, 61797, 61814, 61831, 61848, 61865, 61882, 61899, 61916, 61932, 61949, 61966, 61983, 62000, 62017, 62034, 62051, 62068, 62085, 62102,
            62118, 62135, 62152, 62169, 62186, 62203, 62220, 62236, 62253, 62270, 62287, 62304, 62321, 62337, 62354, 62371, 62388, 62405, 62422, 62438,
            62455, 62472, 62489, 62505, 62522, 62539, 62556, 62573, 62589, 62606, 62623, 62640, 62656, 62673, 62690, 62706, 62723, 62740, 62757, 62773,
            62790, 62807, 62823, 62840, 62857, 62873, 62890, 62907, 62923, 62940, 62957, 62973, 62990, 63007, 63023, 63040, 63057, 63073, 63090, 63106,
            63123, 63140, 63156, 63173, 63190, 63206, 63223, 63239, 63256, 63272, 63289, 63306, 63322, 63339, 63355, 63372, 63388, 63405, 63421, 63438,
            63454, 63471, 63488, 63504, 63521, 63537, 63554, 63570, 63587, 63603, 63619, 63636, 63652, 63669, 63685, 63702, 63718, 63735, 63751, 63768,
            63784, 63801, 63817, 63833, 63850, 63866, 63883, 63899, 63915, 63932, 63948, 63965, 63981, 63997, 64014, 64030, 64047, 64063, 64079, 64096,
            64112, 64128, 64145, 64161, 64177, 64194, 64210, 64226, 64243, 64259, 64275, 64292, 64308, 64324, 64341, 64357, 64373, 64389, 64406, 64422,
            64438, 64455, 64471, 64487, 64503, 64520, 64536, 64552, 64568, 64585, 64601, 64617, 64633, 64650, 64666, 64682, 64698, 64714, 64731, 64747,
            64763, 64779, 64795, 64812, 64828, 64844, 64860, 64876, 64892, 64909, 64925, 64941, 64957, 64973, 64989, 65005, 65021, 65038, 65054, 65070,
            65086, 65102, 65118, 65134, 65150, 65166, 65183, 65199, 65215, 65231, 65247, 65263, 65279, 65295, 65311, 65327, 65343, 65359, 65375, 65391,
            65407, 65423, 65439, 65455, 65471, 65487, 65503, 65519,
        };
        // clang-format on
    }
    // 0x004BE368
    uint16_t fastSquareRoot(uint32_t distance)
    {
        uint8_t i = 10;
        for (; distance >= 4096; --i, distance >>= 2)
            ;

        return Data::kFastSquareRootTable[(distance & 0xFFE) >> 1] >> i;
    }
}
